!function(e){"use strict";e.module("aidemo.service.aStar",["aidemo.service.utils","aidemo.models.node","aidemo.models.queue"]).factory("ReconRetValue",[function(){function e(e){e=e||{},this.map=e.map?e.map:null,this.node=e.node?e.node:null}return e}]).factory("MinHeapRetObj",[function(){function e(e){e=e||{},this.index=_.isUndefined(e.index)?null:e.index,this.other=e.other?e.other:null}return e}]).factory("MinHeapNodes",["MinHeapRetObj","Node",function(e,t){function i(e){e=e||{},this._index=0,this._currentIndex=null,this._currentCapacity=_.isUndefined(e.capacity)?20:e.capacity,this._collection=[];for(var t=0;t<this._currentCapacity;t++)this._collection.push(null)}return i.prototype.count=function(){return this._index-1},i.prototype.minimum=function(){return this._collection[0]},i.prototype.getParent=function(t){var i=new e({index:parseInt(Math.floor((parseFloat(t)-1)/2),10)});return i.index>=0&&(i.other=this._collection[i.index]),i},i.prototype.getLeftChild=function(t){var i=new e({index:2*t+1});return i.index<this._currentCapacity&&(i.other=this._collection[i.index]),i},i.prototype.getRightChild=function(t){var i=new e({index:2*t+2});return i.index<this._currentCapacity&&(i.other=this._collection[i.index]),i},i.prototype.insert=function(e){this._collection[this._index]=e,this.heapifyUp(this._index),this._index++},i.prototype.heapifyUp=function(e){var t=this.getParent(e),i=t.index,o=t.other;this._collection[e]&&(o&&this._collection[e].distance<o.distance?this.swap(i,e):!o&&i>=0&&this.swap(i,e))},i.prototype.swap=function(e,i){var o=this._collection[e]?new t(this._collection[e]):null;this._collection[e]=this._collection[i],this._collection[i]=o},i.prototype.extractMinimum=function(){var e=this.minimum();return this._collection[0]=this._collection[--this._index],this._collection[this._index]=null,this.heapifyResetCurIndex(),e},i.prototype.heapifyResetCurIndex=function(){this._currentIndex=0,this.heapify(this._currentIndex)},i.prototype.getIndexOfSmallest=function(e,t,i,o){return e>t?o:t>e?i:i},i.prototype.heapify=function(e){var t=this.getLeftChild(e),i=this.getRightChild(e),o=t.index,r=i.index,n=t.other,s=i.other;if(!n||!s||0!==n.distance||0!==s.distance)if(n&&s){var a=this.getIndexOfSmallest(n.distance,s.distance,o,r);this.swap(e,a),this.heapify(a)}else!n&&s?this.swap(e,r):n&&!s&&this.swap(e,o)},i.prototype.nodeInHeap=function(e){for(var t=0;t<this._collection.length;t++){var i=this._collection[t];if(i&&i.id===e.id)return!0}return!1},i.prototype.empty=function(){return!this._collection[0]},i}]).service("AStar",["Queue","MinHeapNodes","ReconRetValue",function(e,t,i){var o=this;o.depthFirstSearch=function(t,i){var o=new e;o.enqueue(t);for(var r,n=0,s=0,a=0;0!==o.count();){var c=o.dequeue();c.selected=!0;var h=c.getNeighbors();if(r=0,h.forEach(function(e){o.enqueue(e),r++}),a+=r,--s<=0){if(++n>i)return;s=a,a=0}}},o._heuristicCostEstimate=function(e,t){var i=.9;return parseInt(parseFloat(e.position.subNew(t.position).length())*i,10)},o._reconstructPath=function(e,t,r,n){var s=new i;return t.id===r.id?(n.enqueue(t),s.map=n,s):(_.isUndefined(e[t.id])||_.isNull(e[t.id])?s.node=t:(s=o._reconstructPath(e,e[t.id],r,n),n.enqueue(t),s.map=n),s)},o._resetDistances=function(e){for(var t=0;t<e.length;t++)for(var i=0;i<e[t].length;i++)e[t][i]&&(e[t][i].distance=Number.MAX_VALUE)},o._isNodeInArray=function(e,t){return _.findIndex(e,function(e){return e.id===t.id})>-1},o.aStarAlgorithm=function(i,r,n,s){if(i.id===r.id)return null;s=parseFloat(s),i.distance=0;var a=[],c=new t({capacity:100}),h={},l={};for(c.insert(i),l[i.id]=0,i.distance=o._heuristicCostEstimate(i,r);!c.empty();){var u=c.extractMinimum();if(u.id===r.id)return o._resetDistances(n),o._reconstructPath(h,r,i,new e).map;a.push(u);for(var d=u.getNeighbors(),p=parseFloat(l[u.id])+s,g=0;g<d.length;g++){var m=d[g],f=parseFloat(o._heuristicCostEstimate(m,i)),y=o._isNodeInArray(a,m);y&&p>=f||(!c.nodeInHeap(m)||f>p)&&(h[m.id]=u,l[m.id]=p,m.distance=l[m.id]+parseFloat(o._heuristicCostEstimate(m,r)),c.insert(m))}}return o._resetDistances(n),null}}])}(angular),function(e){"use strict";e.module("aidemo.service.drawUtils",["aidemo.service.utils"]).service("DrawUtils",["Utils",function(e){var t=this;t.defaultFont="12px Verdana",t.clearCanvas=function(e){e.getContext("2d").clearRect(0,0,e.width+1,e.height+1)},t.fillCanvas=function(e,t){e.getContext("2d").fillStyle=t,e.getContext("2d").fillRect(0,0,e.width+1,e.height+1)},t.drawCircle=function(e,t,i,o,r){e.beginPath(),e.arc(t,i,o,0,2*Math.PI,!1),e.fillStyle=r,e.fill(),e.strokeStyle=r,e.stroke(),e.closePath()},t.drawRing=function(e,t,i,o,r){e.beginPath(),e.arc(t,i,o,0,2*Math.PI,!1),e.strokeStyle=r,e.stroke(),e.closePath()},t.drawSquare=function(e,t,i){e.fillStyle=i,e.fillRect(t.x,t.y,t.width,t.height)},t.drawLine=function(e,t,i,o,r,n){e.beginPath(),e.moveTo(t,i),e.lineTo(o,r),e.strokeStyle=n,e.stroke(),e.closePath()},t.drawGrid=function(e,i,o,r){for(var n=0;n<i.height;n+=o)t.drawLine(e,0,n,i.width,n,r);for(var s=0;s<i.width;s+=o)t.drawLine(e,s,0,s,i.height,r);t.drawLine(e,i.width-1,0,i.width-1,i.height,r),t.drawLine(e,0,i.height-1,i.width,i.height-1,r)},t.drawExclamation=function(e,i,o,r){t.drawLine(e,i,o,i,o-1,r),t.drawLine(e,i,o-3,i,o-13,r)},t.drawText=function(e,i,o,r,n){e.font=t.defaultFont,e.fillStyle=r,e.fillText(n,i,o)},t.drawImage=function(e,t,i,o){e.drawImage(o,t,i)},t.drawSprite=function(e,t,i,o,r,n,s,a,c,h){e.drawImage(t,i,o,r,n,s,a,c,h)},t.getColorValueForHex=function(e){e=!_.isNumber(e)&&e?e.toUpperCase():e;var t={A:10,B:11,C:12,D:13,E:14,F:15};return t[e]||e},t.getHexValueForColor=function(e){var t={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"};return t[e]||e},t.isValueAcceptableHexValue=function(e){return _.isNumber(e)&&e>=0&&15>=e},t.convertValueToHexOrMinimum=function(e,i){return e=t.getColorValueForHex(e),t.isValueAcceptableHexValue(e)?e:i},t.getRandomColor=function(){for(var e="0123456789ABCDEF".split(""),t="#",i=0;6>i;i++)t+=e[Math.floor(16*Math.random())];return t},t.getRandomGreen=function(i){var o=t.getRandomColor().split("");return i=t.getColorValueForHex(i),i=_.isNumber(i)?i:5,o[1]=o[2]=o[5]=o[6]="0",o[3]=e.isGreaterThanOrNaN(o[3],i)?o[3]:t.getHexValueForColor(i),o[4]=e.isGreaterThanOrNaN(o[4],i)?o[4]:t.getHexValueForColor(i),o.join("")},t.getRandomRed=function(i){var o=t.getRandomColor().split("");return i=t.getColorValueForHex(i),i=_.isNumber(i)?i:5,o[3]=o[4]=o[5]=o[6]="0",o[1]=e.isGreaterThanOrNaN(o[1],i)?o[1]:t.getHexValueForColor(i),o[2]=e.isGreaterThanOrNaN(o[2],i)?o[2]:t.getHexValueForColor(i),o.join("")},t.getRandomBlue=function(i){var o=t.getRandomColor().split("");return i=t.getColorValueForHex(i),i=_.isNumber(i)?i:5,o[1]=o[2]=o[3]=o[4]="0",o[5]=e.isGreaterThanOrNaN(o[5],i)?o[5]:t.getHexValueForColor(i),o[6]=e.isGreaterThanOrNaN(o[6],i)?o[6]:t.getHexValueForColor(i),o.join("")}}])}(angular),function(e){"use strict";e.module("aidemo.service.gridService",["aidemo.service.utils"]).service("GridService",["$log","Utils",function(e,t){var i=this;i.getNeighborsForCoordinates=function(e,i,o,r){r=_.isBoolean(r)?r:!1;var n=[],s=o.length,a=o[0].length;return n.push(e-1>=0?o[i][e-1]:null),n.push(a>e+1?o[i][e+1]:null),n.push(i-1>=0?o[i-1][e]:null),n.push(s>i+1?o[i+1][e]:null),r||(n.push(e-1>=0&&i-1>=0?o[i-1][e-1]:null),n.push(e-1>=0&&s>i+1?o[i+1][e-1]:null),n.push(a>e+1&&i-1>=0?o[i-1][e+1]:null),n.push(a>e+1&&s>i+1?o[i+1][e+1]:null)),n.filter(function(e){return!t.isNullOrUndefined(e)})},i.fillGridNeighbors=function(e,t){t=_.isBoolean(t)?t:!1;for(var o=0;o<e.length;o++)for(var r=0;r<e[o].length;r++)e[o][r]&&_.isFunction(e[o][r].fillNeighbors)&&e[o][r].fillNeighbors(i.getNeighborsForCoordinates(r,o,e,t));return e},i.deepCopyGrid=function(t,o,r){if(!_.isFunction(o))return e.error("gridObjectType MUST be a function!"),e.log(o),void 0;r=_.isBoolean(r)?r:!1;var n=[];return t.forEach(function(e){var t=[];e.forEach(function(e){e&&t.push(new o({box:e.box,status:e.status}))}),n.push(t)}),i.fillGridNeighbors(n,r)}}])}(angular),function(e){"use strict";e.module("aidemo.service.mathUtils",[]).service("MathUtils",["$window",function(e){var t=this;this._isSameObject=function(e,t){return e===t},this._isDistanceWithinTolerance=function(i,o,r){if(t._isSameObject(i,o))return!1;try{return i.position.distance(o.position)<=r}catch(n){return e.alert(n),!1}},this.getRandomNumber=function(e,t){return Math.random()*(t-e)+e},this.getNearestObjects=function(e,i,o){return e.reduce(function(e,r){return t._isDistanceWithinTolerance(i,r,o)?e.concat(r):e},[])}}])}(angular),function(e){"use strict";e.module("aidemo.service.screenSize",[]).service("ScreenSize",["$window",function(e){var t=this;t.getViewPort=function(){return{width:$(e).width(),height:$(e).height()}}}])}(angular),function(e){"use strict";e.module("aidemo.service.utils",[]).factory("Utils",[function(){var e=function(e){return _.isUndefined(e)||_.isNull(e)},t=function(e,t){return parseInt(e,10)>t||_.isNaN(parseInt(e,10))},i=function(e,t){var i=new Image;return i.src=e[t],i};return{isNullOrUndefined:e,isGreaterThanOrNaN:t,generateImageFromURLObject:i}}])}(angular),function(e){"use strict";e.module("aidemo.models.flockEntity",["aidemo.service.utils","aidemo.service.mathUtils","aidemo.service.drawUtils","aidemo.models.vector"]).factory("FlockEntity",["Utils","DrawUtils","MathUtils","Vector",function(e,t,i,o){function r(e){e=e||{},this.position=e.position||new o,this.velocity=e.velocity||new o,this.speed=_.isNumber(e.speed)?e.speed:3,this.radius=_.isNumber(e.radius)?e.radius:5,this.type=_.isString(e.type)?e.type:r.PREY,this.color=this.type===r.PREY?t.getRandomGreen("D"):t.getRandomRed("D"),this.renderExclamation=!1,this.cohesionWeight=_.isNumber(e.cohesionWeight)?e.cohesionWeight:0,this.separateWeight=_.isNumber(e.separateWeight)?e.separateWeight:0,this.alignWeight=_.isNumber(e.alignWeight)?e.alignWeight:0,this.avoidWeight=_.isNumber(e.avoidWeight)?e.avoidWeight:0}return r.PREY="Prey",r.PREDATOR="Predator",r.EXCLAMATION_COLOR="#FFFF00",r.prototype.updateStats=function(e){e=e||{},this.position=e.position||this.position,this.velocity=e.velocity||this.velocity,this.speed=_.isNumber(e.speed)?e.speed:this.speed,this.radius=_.isNumber(e.radius)?e.radius:this.radius,this.type=_.isString(e.type)?e.type:this.type,this.color=this.type===r.PREY?t.getRandomGreen("D"):t.getRandomRed("D"),this.cohesionWeight=_.isNumber(e.cohesionWeight)?e.cohesionWeight:this.cohesionWeight,this.separateWeight=_.isNumber(e.separateWeight)?e.separateWeight:this.separateWeight,this.alignWeight=_.isNumber(e.alignWeight)?e.alignWeight:this.alignWeight,this.avoidWeight=_.isNumber(e.avoidWeight)?e.avoidWeight:this.avoidWeight},r.prototype.calculateCohesion=function(e){if(0===e.length)return new o;var t=new o;return e.forEach(function(e){t.add(e.position)}),t.divNew(e.length).subNew(this.position).normalize()},r.prototype._calculateSeparationForceForTarget=function(e){return this.position.subNew(e.position).normalize()},r.prototype.calculateSeparation=function(e){var t=this,i=new o;return e.forEach(function(e){i.add(t._calculateSeparationForceForTarget(e))}),i.normalize()},r.prototype.calculateAlignment=function(e){var t=new o;return e.forEach(function(e){t.add(e.velocity)}),t.normalize()},r.prototype.avoidWalls=function(e){var t=new o;return this.position.x<50?t.x=1:this.position.x>e.width-50&&(t.x=-1),this.position.y<50?t.y=1:this.position.y>e.height-50&&(t.y=-1),t},r.prototype._updateAsPreyWithPredators=function(e){this.renderExclamation=!0;var t=this.calculateSeparation(e).mulNew(this.avoidWeight);return this.velocity.addNew(t)},r.prototype._updateAsPreyNormal=function(e){this.renderExclamation=!1;var t=i.getNearestObjects(e.prey,this,80),o=this.calculateCohesion(t).mulNew(this.cohesionWeight),r=this.calculateSeparation(t).mulNew(this.separateWeight),n=this.calculateAlignment(t).mulNew(this.alignWeight),s=this.avoidWalls(e.box).mulNew(.1),a=o.addNew(r).addNew(n).addNew(s);return this.velocity.addNew(a)},r.prototype.updateAsPrey=function(e){var t=i.getNearestObjects(e.predators,this,80);return 0!==t.length?this._updateAsPreyWithPredators(t):this._updateAsPreyNormal(e)},r.prototype.updateAsPredator=function(e){var t=i.getNearestObjects(e.prey,this,80),o=i.getNearestObjects(e.predators,this,80),r=this.calculateCohesion(t).mulNew(this.cohesionWeight),n=this.calculateSeparation(o).mulNew(this.separateWeight),s=this.calculateAlignment(o).mulNew(this.alignWeight),a=this.avoidWalls(e.box).mulNew(.1),c=r.addNew(n).addNew(s).addNew(a);return this.velocity.addNew(c)},r.prototype.updateVelocity=function(e){var t=this["updateAs"+this.type](e);return t.normalize().mulNew(this.speed)},r.prototype._bounceOffWalls=function(e){(this.position.x<this.radius||this.position.x>e.width-this.radius)&&(this.velocity.x*=-1),(this.position.y<this.radius||this.position.y>e.height-this.radius)&&(this.velocity.y*=-1)},r.prototype._keepInBounds=function(e){this.position.x<this.radius?this.position.x=this.radius:this.position.x>e.width-this.radius&&(this.position.x=e.width-this.radius),this.position.y<this.radius?this.position.y=this.radius:this.position.y>e.height-this.radius&&(this.position.y=e.height-this.radius)},r.prototype.update=function(e){this.velocity=this.updateVelocity(e),this.position=this.velocity.addNew(this.position),this._bounceOffWalls(e.box),this._keepInBounds(e.box)},r.prototype.calcNose=function(){this.nose=this.velocity.normalize(),this.nose=this.nose.mulNew(10),this.nose=this.nose.addNew(this.position)},r.prototype.render=function(e){this.calcNose(),this.renderExclamation&&t.drawExclamation(e,this.position.x,this.position.y-10,r.EXCLAMATION_COLOR),t.drawCircle(e,this.position.x,this.position.y,this.radius,this.color),t.drawLine(e,this.position.x,this.position.y,this.nose.x,this.nose.y,this.color)},r}])}(angular),function(e){"use strict";e.module("aidemo.models.lifeCell",["aidemo.service.utils","aidemo.service.drawUtils"]).factory("LifeCell",["Utils","DrawUtils",function(e,t){function i(e){e=e||{},this.neighbors=[],this.box=e.box?e.box:{x:0,y:0,width:0,height:0},this.status=e.status===this.DEAD||e.status===this.ALIVE?e.status:this.DEAD,this.DEAD_COLOR=e.DEAD_COLOR||this.DEAD_COLOR,this.ALIVE_COLOR=e.ALIVE_COLOR||this.ALIVE_COLOR,this.color=this.status===this.DEAD?this.DEAD_COLOR:this.ALIVE_COLOR}return i.prototype.DEAD_COLOR="#222222",i.prototype.ALIVE_COLOR="#00FF00",i.prototype.DEAD="DEAD",i.prototype.ALIVE="ALIVE",i.DEAD=i.prototype.DEAD,i.ALIVE=i.prototype.ALIVE,i.prototype.fillNeighbors=function(e){this.neighbors=_.isArray(e)?e:[]},i.prototype.deadRules=function(e){return 3===e?this.ALIVE:this.DEAD},i.prototype.aliveRules=function(e){return 2===e||3===e?this.ALIVE:this.DEAD},i.prototype.rules=function(e){return this[this.status.toLowerCase()+"Rules"](e)},i.prototype.setStatus=function(e){this.status=e===this.DEAD||e===this.ALIVE?e:this.DEAD,this.color=this[this.status+"_COLOR"]},i.prototype.update=function(){var e=0,t=this;return this.neighbors.forEach(function(i){i.status===t.ALIVE&&e++}),this.rules(e)},i.prototype.render=function(e){var i=this.box.width/2,o=parseInt(this.box.width/3,10);t.drawCircle(e,this.box.x-i,this.box.y-i,o,this.color)},i}])}(angular),function(e){"use strict";e.module("aidemo.models.neuron",[]).factory("Neuron",[function(){function e(e){e=e||{}}return e}])}(angular),function(e){"use strict";e.module("aidemo.models.node",["aidemo.service.utils","aidemo.service.mathUtils","aidemo.service.drawUtils","aidemo.models.vector"]).factory("Node",["Utils","DrawUtils","MathUtils","Vector",function(e,t,i,o){function r(e){e=e||{},this.id=e.id?e.id:null,this.position=e.position?e.position:new o,this.distance=e.distance?e.distance:0,this.box=e.box?e.box:{},this.neighbors=e.neighbors?e.neighbors:[],this.selected=e.selected?e.selected:!1,this.special=e.special?e.special:!1,this.path=e.path?e.path:!1}return r.prototype.SELECTED_COLOR="#FFFFFF",r.prototype.SPECIAL_COLOR="#FF0000",r.prototype.RENDER_COLOR="#000000",r.prototype.PATH_COLOR="#00FF00",r.prototype.RANGE=10,r.prototype.getNeighbors=function(){return this.neighbors},r.prototype.fillNeighbors=function(e){this.neighbors=_.isArray(e)?e:[]},r.prototype.reset=function(){this.selected=!1,this.special=!1,this.path=!1},r.prototype.eligibleForSelect=function(e){return!this.special&&this.specialSelect(e)},r.prototype.select=function(e){var t=this.position.subNew(e).length();this.selected=t<=this.RANGE},r.prototype.specialSelect=function(e){var t=this.position.subNew(e).length();return this.special=t<=this.RANGE,this.special},r.prototype.pathSelect=function(){this.path=!this.special},r.prototype.update=function(){},r.prototype.renderPaths=function(e){var i=this;this.neighbors.forEach(function(o){if(o.position){var r=(o.path||o.special)&&(i.path||i.special)?i.PATH_COLOR:i.RENDER_COLOR;t.drawLine(e,i.position.x,i.position.y,o.position.x,o.position.y,r)}})},r.prototype.getColor=function(){return this.special?this.SPECIAL_COLOR:this.path?this.PATH_COLOR:this.selected?this.SELECTED_COLOR:this.RENDER_COLOR},r.prototype.render=function(e){this.renderPaths(e),t.drawCircle(e,this.position.x,this.position.y,5,this.getColor())},r}])}(angular),function(e){"use strict";e.module("aidemo.models.queue",[]).factory("Queue",[function(){function e(){this.queue=[],this.offset=0}return e.prototype.count=function(){return this.queue.length-this.offset},e.prototype.isEmpty=function(){return 0===this.queue.length},e.prototype.enqueue=function(e){this.queue.push(e)},e.prototype.dequeue=function(){if(0===this.queue.length)return void 0;var e=this.queue[this.offset];return 2*++this.offset>=this.queue.length&&(this.queue=this.queue.slice(this.offset),this.offset=0),e},e.prototype.peek=function(){return this.queue.length>0?this.queue[this.offset]:void 0},e}])}(angular),function(e){"use strict";e.module("aidemo.models.vector",[]).factory("Vector",[function(){function e(e){e=e||{},this.x=_.isNumber(e.x)?e.x:0,this.y=_.isNumber(e.y)?e.y:0}return e.build=function(t){return new e(t)},e.prototype.compare=function(e){return this.x===e.x&&this.y===e.y},e.prototype.length=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},e.prototype.magnitude=function(){return this.length()},e.prototype.normalize=function(t){t=t||1;var i=this.length();return 0===i?this:new e({x:this.x/i*t,y:this.y/i*t})},e.prototype.addNew=function(t){return new e({x:this.x+t.x,y:this.y+t.y})},e.prototype.add=function(e){this.x+=e.x,this.y+=e.y},e.prototype.subNew=function(t){return new e({x:this.x-t.x,y:this.y-t.y})},e.prototype.sub=function(e){this.x-=e.x,this.y-=e.y},e.prototype.mulNew=function(t){return new e({x:this.x*t,y:this.y*t})},e.prototype.mul=function(e){this.x*=e,this.y*=e},e.prototype.divNew=function(t){return new e({x:this.x/t,y:this.y/t})},e.prototype.div=function(e){this.x/=e,this.y/=e},e.angleToVector=function(t){return t=t*Math.PI/180,new e({x:Math.round(100*parseFloat(Math.cos(t)))/100,y:Math.round(100*parseFloat(Math.sin(t)))/100})},e.prototype.vectorToAngleRadians=function(){return parseFloat(Math.atan2(this.y,this.x))},e.prototype.vectorToAngleDegrees=function(){return 180*this.vectorToAngleRadians()/Math.PI},e.prototype.distance=function(e){return this.subNew(e).length()},e.prototype.toString=function(){return{x:this.x,y:this.y}},e}])}(angular),function(e){"use strict";e.module("aidemo.models.ants.ant",["aidemo.service.utils","aidemo.service.mathUtils","aidemo.service.drawUtils","aidemo.models.flockEntity","aidemo.models.vector","aidemo.models.ants.pheromone"]).factory("Ant",["Utils","DrawUtils","MathUtils","FlockEntity","Vector","Pheromone",function(e,t,i,o,r,n){function s(e){e=e||{},o.call(this,e),this.previousPosition=this.position,this.pheromoneWeight=_.isNumber(e.pheromoneWeight)?e.pheromoneWeight:0,this.color="#000000",this.hasFood=!1,this.steps=0,this.stepsToNextPheromone=40,this.id=_.isNumber(e.id)?e.id:0}return s.prototype=Object.create(o.prototype),s.prototype.constructor=s,s.prototype.attemptToSpawnPheromone=function(){return this.steps>=this.stepsToNextPheromone?(this.steps=0,new n({position:new r(this.position),id:this.id,hasFood:this.hasFood})):null},s.prototype._getPheromoneWeight=function(e){return this.hasFood&&e.hasFood?0:this.hasFood&&!e.hasFood?e.id===this.id?1:.2:e.hasFood?.2:0},s.prototype._calculatePheromoneForceForTarget=function(e){var t=e.position.subNew(this.position).normalize(),i=t.mulNew(this._getPheromoneWeight(e));return i.mulNew(e.getAgeWeight())},s.prototype.calculatePheromones=function(e){if(0===e.length)return new r;var t=this,i=new r;return e.forEach(function(e){i.add(t._calculatePheromoneForceForTarget(e))}),i.normalize()},s.prototype._getFoodWeight=function(){return this.hasFood?0:1},s.prototype._getNestWeight=function(){return this.hasFood?1:0},s.prototype.updateVelocity=function(e){var t=i.getNearestObjects(e.ants,this,100),o=i.getNearestObjects(e.food,this,100),r=i.getNearestObjects(e.pheromones,this,100),n=i.getNearestObjects([e.nest],this,100),s=this.calculateCohesion(t).mulNew(this.cohesionWeight),a=this.calculateCohesion(o).mulNew(this._getFoodWeight()),c=this.calculatePheromones(r).mulNew(this.pheromoneWeight),h=this.calculateCohesion(n).mulNew(this._getNestWeight()),l=this.calculateSeparation(t).mulNew(this.separateWeight),u=this.calculateAlignment(t).mulNew(this.alignWeight),d=this.avoidWalls(e.box).mulNew(.1);return s.addNew(a).addNew(c).addNew(h).addNew(l).addNew(u).addNew(d).addNew(this.velocity).normalize().mulNew(this.speed)},s.prototype._updateStepsAndGetNewPosition=function(e){var t=e.addNew(this.position);return this.steps+=t.subNew(this.previousPosition).length(),this.previousPosition=t,t},s.prototype.update=function(e){this.velocity=this.updateVelocity(e),this.position=this._updateStepsAndGetNewPosition(this.velocity),this._bounceOffWalls(e.box),this._keepInBounds(e.box)},s.prototype._calcHead=function(){var e=this.velocity.normalize().mulNew(4);return e.addNew(this.position)},s.prototype._calcRear=function(){var e=this.velocity.normalize().mulNew(-4);return e.addNew(this.position)},s.prototype.render=function(e){var i=this._calcHead(),o=this._calcRear();t.drawCircle(e,this.position.x,this.position.y,2,this.color),t.drawCircle(e,i.x,i.y,2,this.color),t.drawCircle(e,o.x,o.y,2,this.color)},s}])}(angular),function(e){"use strict";e.module("aidemo.models.ants.food",["aidemo.service.drawUtils","aidemo.models.vector"]).factory("Food",["DrawUtils","Vector",function(e,t){function i(i){i=i||{},this.position=i.position||new t,this.radius=10,this.color=e.getRandomGreen("A")}return i.prototype.takeBite=function(){return this.radius-=.1,this.radius<=0},i.prototype.render=function(t){e.drawCircle(t,this.position.x,this.position.y,this.radius,this.color)},i}])}(angular),function(e){"use strict";e.module("aidemo.models.ants.nest",["aidemo.service.mathUtils","aidemo.service.drawUtils","aidemo.models.vector","aidemo.models.ants.ant"]).factory("Nest",["MathUtils","DrawUtils","Vector","Ant",function(e,t,i,o){function r(e){e=e||{},this.position=e.position||new i,this.radius=10,this.colorInner=t.getRandomBlue("A"),this.colorOuter=t.getRandomRed("A"),this.foodStore=_.isNumber(e.foodStore)?e.foodStore:5,this.weights=e.weights||{},this.id=0,this.currentTime=0,this.timeToNextAnt=2}return r.prototype._updateTime=function(e){return this.currentTime+=e,this.currentTime>=this.timeToNextAnt?(this.currentTime=0,!0):!1},r.prototype._spawnAnt=function(){return this.id++,new o({position:new i(this.position),velocity:new i({x:e.getRandomNumber(-1,1),y:e.getRandomNumber(-1,1)}),speed:.5,cohesionWeight:this.weights.cohesionWeight,avoidWeight:this.weights.avoidWeight,separateWeight:this.weights.separateWeight,alignWeight:this.weights.alignWeight,pheromoneWeight:this.weights.pheromoneWeight,id:this.id})},r.prototype.updateTimeAndAttemptToSpawnAnt=function(e){var t=this._updateTime(e);return!t||this.foodStore<1?null:(this.foodStore-=1,this._spawnAnt())},r.prototype.addFood=function(){this.foodStore+=.1},r.prototype.render=function(e){t.drawCircle(e,this.position.x,this.position.y,this.radius,this.colorInner),t.drawRing(e,this.position.x,this.position.y,this.radius,this.colorOuter)},r}])}(angular),function(e){"use strict";e.module("aidemo.models.ants.pheromone",["aidemo.service.mathUtils","aidemo.service.drawUtils","aidemo.models.vector"]).factory("Pheromone",["Utils","DrawUtils","MathUtils","Vector",function(e,t,i,o){function r(e){e=e||{},this.position=e.position||new o,this.timeToLive=15,this.currentTime=0,this.id=_.isNumber(e.id)?e.id:0,this.hasFood=e.hasFood,this.color=this.hasFood?"#FF00FF":"#FFFFFF"}return r.prototype.getAgeWeight=function(){return this.currentTime/this.timeToLive},r.prototype.update=function(e){return this.currentTime+=e,this.currentTime>=this.timeToLive},r.prototype.render=function(e){t.drawCircle(e,this.position.x,this.position.y,2,this.color)},r}])}(angular),function(e){"use strict";e.module("aidemo.models.chip.item",["aidemo.service.utils","aidemo.service.drawUtils"]).factory("Item",["Utils","DrawUtils",function(e,t){function i(t){if(t=t||{},!t.type)throw new Error("ERROR INSTANTIATING ITEM: MUST HAVE A TYPE");this.type=t.type,this.image=e.generateImageFromURLObject(i.ITEM_IMAGES,this.type)}var o="images/chipsChallenge/items/";return i.ITEM_IMAGES={FLIPPERS:o+"flippersLarge.png",FIRE_BOOTS:o+"fireBootsLarge.png",ROLLER_SKATES:o+"rollerSkatesLarge.png",ICE_SKATES:o+"iceSkatesLarge.png",BLUE_KEY:o+"blueKeyLarge.png",RED_KEY:o+"redKeyLarge.png",GREEN_KEY:o+"greenKeyLarge.png",YELLOW_KEY:o+"yellowKeyLarge.png",MICRO_CHIP:o+"microChipLarge.png"},i.FLIPPERS="FLIPPERS",i.FIRE_BOOTS="FIRE_BOOTS",i.ROLLER_SKATES="ROLLER_SKATES",i.ICE_SKATES="ICE_SKATES",i.BLUE_KEY="BLUE_KEY",i.RED_KEY="RED_KEY",i.GREEN_KEY="GREEN_KEY",i.YELLOW_KEY="YELLOW_KEY",i.MICRO_CHIP="MICRO_CHIP",i.prototype.isMicrochip=function(){return this.type===i.MICRO_CHIP},i.prototype.getType=function(){return this.type},i.prototype.update=function(){},i.prototype.render=function(e,i,o){t.drawImage(e,i,o,this.image)},i}])}(angular),function(e){"use strict";e.module("aidemo.models.chip.obstacle",["aidemo.service.utils","aidemo.service.drawUtils"]).factory("Obstacle",["Utils","DrawUtils",function(e,t){function i(t){if(t=t||{},!t.type)throw new Error("ERROR INSTANTIATING OBSTACLE: MUST HAVE A TYPE");this.type=t.type,this.image=e.generateImageFromURLObject(i.OBSTACLE_IMAGES,this.type)}var o="images/chipsChallenge/obstacles/";return i.OBSTACLE_IMAGES={CHIP_DOOR:o+"chipDoorLarge.png",PUSH_BLOCK:o+"pushBlockLarge.png",BLUE_DOOR:o+"blueDoorLarge.png",GREEN_DOOR:o+"greenDoorLarge.png",RED_DOOR:o+"redDoorLarge.png",YELLOW_DOOR:o+"yellowDoorLarge.png"},i.DOOR="DOOR",i.KEY="KEY",i.CHIP_DOOR="CHIP_DOOR",i.PUSH_BLOCK="PUSH_BLOCK",i.BLUE_DOOR="BLUE_DOOR",i.GREEN_DOOR="GREEN_DOOR",i.RED_DOOR="RED_DOOR",i.YELLOW_DOOR="YELLOW_DOOR",i.prototype.isColoredDoor=function(){return this.type!==i.CHIP_DOOR&&this.type.slice(-4)===i.DOOR},i.prototype.doorToKey=function(){var e=this.type.split(i.DOOR);return e.push(i.KEY),e.join("")},i.prototype.getType=function(){return this.type},i.prototype.update=function(){},i.prototype.render=function(e,i,o){t.drawImage(e,i,o,this.image)},i}])}(angular),function(e){"use strict";e.module("aidemo.models.chip.player",["aidemo.service.utils","aidemo.service.drawUtils","aidemo.models.chip.globals","aidemo.models.chip.item","aidemo.models.chip.tile","aidemo.models.chip.sound"]).factory("Player",["Utils","DrawUtils","Globals","Item","Tile","Sound",function(e,t,i,o,r,n){function s(t){t=t||{};var o={FLIPPERS:null,FIRE_BOOTS:null,ROLLER_SKATES:null,ICE_SKATES:null,BLUE_KEY:null,RED_KEY:null,GREEN_KEY:null,YELLOW_KEY:null};this.worldPos=t.worldPos?t.worldPos:new Vector,this.screenPos=t.screenPos?t.screenPos:new Vector,this.specialSlots=null,_.merge(this.specialSlots,o,t.specialSlots),this.numberOfMicrochips=_.isNumber(t.numberOfMicrochips)?t.numberOfMicrochips:0,this.normalSprites=e.generateImageFromURLObject(s.PLAYER_IMAGES,s.NORMAL_SPRITE_SHEET),this.waterSprites=e.generateImageFromURLObject(s.PLAYER_IMAGES,s.WATER_SPRITE_SHEET),this.activeSpriteSheet=this.normalSprites,this.curSprite=t.curSprite?t.curSprite:{x:0,y:0,w:i.TILE_SIZE,h:i.TILE_SIZE},this.itemsBack=e.generateImageFromURLObject(r.TILE_IMAGES,r.EMPTY),this.ssKeys=Object.keys(this.specialSlots),this.deathSound=new n({soundFile:n.DEATH}),this.status=i.ALIVE,this.direction=i.DOWN}var a="images/chipsChallenge/player/";return s.PLAYER_IMAGES={NORMAL_SPRITE_SHEET:a+"chipLarge.png",WATER_SPRITE_SHEET:a+"chipWaterLarge.png",WATER_DEATH_SPRITE:a+"waterDeathLarge.png",FIRE_DEATH_SPRITE:a+"fireDeathLarge.png"},s.prototype.getStatus=function(){return this.status},s.prototype.getTileIndex=function(e){return e||(e=i.TILE_SIZE),{x:this.worldPos.x/e,y:this.worldPos.y/e}},s.prototype.move=function(e){this.worldPos.add(e),this._setCurSpriteParams(e)},s.prototype.removeItem=function(e){this.specialSlots[e]=null},s.prototype._addItem=function(e){return this.specialSlots[e.type]=e,!0},s.prototype._addToMicrochips=function(){return this.numberOfMicrochips++,!0},s.prototype.pickUp=function(e){return e?e.isMicrochip()?this._addToMicrochips(e):this._addItem(e):!1},s.prototype._setCurSpriteParams=function(e){e===i.DOWN?this.curSprite.x=0:e===i.LEFT?this.curSprite.x=this.curSprite.w:e===i.UP?this.curSprite.x=2*this.curSprite.w:e===i.RIGHT&&(this.curSprite.x=3*this.curSprite.w)},s.prototype._killPlayer=function(e){var t=new Image;t.src=e,this._setCurSpriteParams(DOWN),this.activeSpriteSheet=t,this.status=DEAD,this.deathSound.play(.8)},s.prototype._resetSprite=function(){this.activeSpriteSheet===this.waterSprites&&(this.activeSpriteSheet=this.normalSprites)},s.prototype.handleTile=function(t){this._resetSprite(),t.getType()===r.EXIT&&(this.status=i.COMPLETE),this.pickUp(t.getItem())&&t.removeItem(),t.getType()===r.WATER_BLOCK?t.setType(r.EMPTY):t.getType()===r.WATER?null===this.specialSlots.FLIPPERS?this._killPlayer(e.generateImageFromURLObject(s.PLAYER_IMAGES,s.WATER_DEATH_SPRITE)):this.activeSpriteSheet=this.waterSprites:t.getType()===r.FIRE&&null===this.specialSlots.FIRE_BOOTS?this._killPlayer(e.generateImageFromURLObject(s.PLAYER_IMAGES,s.FIRE_DEATH_SPRITE)):t.getType()===r.ICE&&null===this.specialSlots.ICE_SKATES},s.prototype.update=function(){},s.prototype.renderItems=function(e){for(var o=0;8>o;o++)t.drawImage(ctx,o*i.TILE_SIZE,0,this.itemsBack),null!==this.specialSlots[this.ssKeys[o]]&&this.specialSlots[this.ssKeys[o]].render(e,o*i.TILE_SIZE,0)},s.prototype.render=function(e){t.drawSprite(e,this.activeSpriteSheet,this.curSprite.x,this.curSprite.y,this.curSprite.w,this.curSprite.h,this.screenPos.x,this.screenPos.y,this.curSprite.w,this.curSprite.h)},s}])}(angular),function(e){"use strict";e.module("aidemo.models.chip.sound",[]).factory("Sound",[function(){function t(t){if(t=t||{},!t.soundFile)throw new Error("ERROR INSTANTIATING SOUND: MUST HAVE A SOUNDFILE");this.soundFile=t.soundFile,this.audioElement=e.element("<audio />"),this.audioElement.preload="auto";var i=e.element("<source />");i.src=this.soundFile+".mp3",this.audioElement.appendChild(i),this.audioElement.load(),this.audioElement.volume=1}var i="sounds/";return t.DEATH=i+"death",t.prototype.play=function(e){this.audioElement.currentTime=_.isNumber(e)?e:.01,this.audioElement.play()},t}])}(angular),function(e){"use strict";e.module("aidemo.models.chip.tile",["aidemo.service.utils","aidemo.service.drawUtils","aidemo.models.chip.globals","aidemo.models.vector"]).factory("Tile",["Utils","DrawUtils","Globals","Vector",function(e,t,i,o){function r(t){if(t=t||{},!t.type)throw new Error("ERROR INSTANTIATING TILE: MUST HAVE A TYPE");this.type=t.type,this.worldPos=t.worldPos?t.worldPos:new o,this.screenPos=t.screenPos?t.screenPos:new o,this.image=e.generateImageFromURLObject(r.TILE_IMAGES,this.type),this.item=t.item?t.item:null,this.obstacle=t.obstacle?t.obstacle:null,this.neighbors=t.neighbors?t.neighbors:[]}var n="images/chipsChallenge/tiles/";return r.TILE_IMAGES={EMPTY:n+"emptyLarge.png",BLOCK:n+"blockLarge.png",WATER_BLOCK:n+"waterBlockLarge.png",WATER:n+"waterLarge.png",FIRE:n+"fireLarge.png",ROLLER:n+"ROLLER",ICE:n+"iceLarge.png",ICE_LD:n+"iceLDLarge.png",ICE_RD:n+"iceRDLarge.png",ICE_LU:n+"iceLULarge.png",ICE_RU:n+"iceRULarge.png",EXIT:n+"exitLarge.png"},r.EMPTY="EMPTY",r.BLOCK="BLOCK",r.WATER_BLOCK="WATER_BLOCK",r.WATER="WATER",r.FIRE="FIRE",r.ROLLER="ROLLER",r.ICE="ICE",r.ICE_LD="ICE_LD",r.ICE_RD="ICE_RD",r.ICE_LU="ICE_LU",r.ICE_RU="ICE_RU",r.EXIT="EXIT",r.prototype.getNeighborTileInDirection=function(e){if(e.length()!==i.TILE_SIZE)throw new Error("ERROR GETTING NEIGHBOR FOR TILE: DIRECTION X OR Y MUST MATCH GLOBALS.TILE_SIZE");
for(var t=this.worldPos.addNew(e),o=0;o<this.neighbors.length;o++)if(t.compare(this.neighbors[o].worldPos))return this.neighbors[o]},r.prototype.getNeighbors=function(){return this.neighbors},r.prototype.fillNeighbors=function(e){this.neighbors=e?e:[]},r.prototype.move=function(e){this.screenPos.add(e)},r.prototype.removeItem=function(){this.item=null},r.prototype.getItem=function(){return this.item},r.prototype.removeObstacle=function(){this.obstacle=null},r.prototype.getObstacle=function(){return this.obstacle},r.prototype.setObstacle=function(e){this.obstacle=e},r.prototype.getType=function(){return this.type},r.prototype.setType=function(t){this.type=t,this.image=e.generateImageFromURLObject(r.TILE_IMAGES,this.type)},r.prototype._iceGetDir=function(e){return e.split(r.ICE,"_")},r.prototype.iceGetDir=function(e){return this.type===r.ICE?e:void 0},r.prototype.update=function(){},r.prototype._renderItem=function(e){this.item&&this.item.render(e,this.screenPos.x,this.screenPos.y)},r.prototype._renderObstacle=function(e){this.obstacle&&this.obstacle.render(e,this.screenPos.x,this.screenPos.y)},r.prototype.render=function(e){t.drawImage(e,this.screenPos.x,this.screenPos.y,this.image),this._renderItem(e),this._renderObstacle(e)},r}])}(angular),function(){"use strict";angular.module("aidemo.models.chip.globals",["aidemo.models.vector"]).service("Globals",["Vector",function(e){var t=this;t.TILE_SIZE=64,t.UP=new e({y:-t.TILE_SIZE}),t.DOWN=new e({y:t.TILE_SIZE}),t.LEFT=new e({x:-t.TILE_SIZE}),t.RIGHT=new e({x:t.TILE_SIZE}),t.DEAD="DEAD",t.ALIVE="ALIVE",t.COMPLETE="COMPLETE"}])}(angular),function(e){"use strict";e.module("aidemo.ui.canvas",["aidemo.service.drawUtils","aidemo.models.vector"]).directive("canvasScreen",["$window","$interval","$timeout","DrawUtils","Vector",function(e,t,i,o,r){return{restrict:"E",replace:!0,scope:{hasGrid:"@",bgColor:"@",box:"=",gridColor:"@?",gridSpacing:"=?",gridIsBackground:"@?gridBg",height:"=?",width:"=?",minHeight:"=?",minWidth:"=?",objects:"=?",customRender:"&?",onUpdate:"&?",touch:"&?"},link:function(t,n){t.canvasContext={},t.requestID=null,t.drawing=!1,t.lastTime=0,t.startTouch=function(e){t.touch({event:e}),t.drawing=!0},t.continueTouch=function(e){t.drawing&&t.touch({event:e})},t.stopTouch=function(e){t.touch({event:e}),t.drawing=!1},t.bindTouchEvents=function(){n.bind("mousedown touchstart",t.startTouch),n.bind("mousemove touchmove",t.continueTouch),n.bind("mouseup touchend",t.stopTouch)},t.resizeHandler=function(){t.resizeCanvasAndSetBox(),t.$apply()},t.renderObject=function(e){e&&(_.isFunction(e.render)?e.render(t.canvasContext):_.isArray(e)?e.forEach(t.renderArrayOrObjectsArrays):t.renderArraysInObject(e))},t.renderArraysInObject=function(e){for(var i in e)e.hasOwnProperty(i)&&t.renderArrayOrObjectsArrays(e[i])},t.renderArrayOrObjectsArrays=function(e){_.isArray(e)&&e.length>0?e.forEach(t.renderArrayOrObjectsArrays):t.renderObject(e)},t.renderGrid=function(){t.canvasHasGrid&&o.drawGrid(t.canvasContext,t.box,t.gridSpacing,t.gridColor)},t.render=function(){o.fillCanvas(t.canvas,t.bgColor),t.canvasGridIsBackground||t.renderGrid(),_.isFunction(t.customRender)?t.customRender({context:t.canvasContext}):t.renderArrayOrObjectsArrays(t.objects),t.canvasGridIsBackground&&t.renderGrid()},t.animateScene=function(){_.isFunction(t.onUpdate)&&t.onUpdate(),t.render(),t.requestID=e.requestAnimationFrame(t.animateScene)},t.setHeightAndWidthFromMinimumValues=function(){_.isNumber(t.height)&&_.isNumber(t.minHeight)&&t.height<t.minHeight&&(t.height=t.minHeight),_.isNumber(t.width)&&_.isNumber(t.minWidth)&&t.width<t.minWidth&&(t.width=t.minWidth)},t.setBoxObject=function(e,i){t.box={width:i,height:e,center:new r({x:i/2,y:e/2})}},t.setCanvasHeight=function(e){_.isNumber(t.height)?(n.css("height",t.height+"px"),t.canvas.height=t.height):e&&(n.css("height",e.offsetHeight+"px"),t.canvas.height=e.offsetHeight)},t.setCanvasWidth=function(e){_.isNumber(t.width)?(n.css("width",t.width+"px"),t.canvas.width=t.width):e&&(n.css("width",e.offsetWidth+"px"),t.canvas.width=e.offsetWidth)},t.resizeCanvasAndSetBox=function(){var e=angular.element(n.parent())[0];t.setCanvasHeight(e),t.setCanvasWidth(e),t.setBoxObject(t.canvas.height,t.canvas.width)},t.setupResizeHandler=function(){var i,o=angular.element(e);i=_.debounce(t.resizeHandler,100),o.on("resize",i),t.$on("$viewContentLoaded",i)},n.on("$destroy",function(){e.cancelAnimationFrame(t.requestID)}),t.requestAnimationFrameDefaultFunction=function(e){var o=(new Date).getTime(),r=Math.max(0,16-(o-t.lastTime)),n=i(function(){e(o+r)},r);return t.lastTime=o+r,n},t.cancelAnimationFrameDefaultFunction=function(t){e.clearTimeout(t)},t.stringToBoolean=function(e){var t=["t","true","yes","y"];return _.findIndex(t,function(t){return t===e.toLowerCase()})>-1},function(){t.canvasHasGrid=t.stringToBoolean(t.hasGrid),t.canvasGridIsBackground=t.gridIsBackground?t.stringToBoolean(t.gridIsBackground):!1,t.gridSpacing=t.gridSpacing?t.gridSpacing:20,t.objects=t.objects?t.objects:[],t.setHeightAndWidthFromMinimumValues(),t.canvas=n[0],t.canvasContext=t.canvas.getContext("2d"),t.resizeCanvasAndSetBox(),_.isNumber(t.height)&&_.isNumber(t.width)||t.setupResizeHandler(),_.isFunction(t.touch)&&t.bindTouchEvents();for(var i=["ms","moz","webkit","o"],o=0;o<i.length&&!window.requestAnimationFrame;++o)e.requestAnimationFrame=window[i[o]+"RequestAnimationFrame"],e.cancelAnimationFrame=window[i[o]+"CancelAnimationFrame"]||window[i[o]+"CancelRequestAnimationFrame"];e.requestAnimationFrame||(e.requestAnimationFrame=t.requestAnimationFrameDefaultFunction),e.cancelAnimationFrame||(e.cancelAnimationFrame=t.cancelAnimationFrameDefaultFunction),t.requestID=e.requestAnimationFrame(t.animateScene)}()},template:'<canvas class="screen"></canvas>'}}])}(angular),function(e){"use strict";e.module("aidemo.flock",["ui.router","aidemo.service.screenSize","aidemo.service.mathUtils","aidemo.service.drawUtils","aidemo.models.vector","aidemo.models.flockEntity"]).controller("FlockController",["$scope","ScreenSize","MathUtils","DrawUtils","Vector","FlockEntity",function(e,t,i,o,r,n){var s=this,a="Wolves",c="Zombies";s.box={},s.BACK_COLOR="#555555",s.GRID_COLOR="#8EAEC9",s.entities={prey:[],predators:[]},s.preyAmount=50,s.predatorAmount=2,s.predatorStats={speed:.7,cohesionWeight:.5,separateWeight:.5,alignWeight:.5},s.preyStats={speed:.5,cohesionWeight:.5,separateWeight:.51,alignWeight:.49,avoidWeight:1},s.gameType=a;var h=t.getViewPort();s.viewport={height:h.height/2.2,width:h.width/2},s.updateStats=function(e,t){for(var i in s.entities[t])s.entities[t][i]&&s.entities[t][i].updateStats({speed:parseFloat(e.speed),cohesionWeight:parseFloat(e.cohesionWeight),separateWeight:parseFloat(e.separateWeight),alignWeight:parseFloat(e.alignWeight)})},e.$watch(function(){return s.preyStats},function(e,t){e!==t&&s.updateStats(e,"prey")}),e.$watch(function(){return s.preyStats},function(e,t){e!==t&&s.updateStats(e,"predators")}),s.toggleGameType=function(){s.gameType=s.gameType===a?c:a,s.clear()},s.reset=function(){s.entities.prey=s.createPreyArray(s.preyAmount),s.entities.predators=s.createPredatorsArray(s.predatorAmount)},s.createFlockEntity=function(e,t,i){return new n({position:t.position,velocity:t.velocity,speed:parseFloat(e.speed),cohesionWeight:parseFloat(e.cohesionWeight),avoidWeight:parseFloat(e.avoidWeight),separateWeight:parseFloat(e.separateWeight),alignWeight:parseFloat(e.alignWeight),type:i})},s.createPreyArray=function(e){for(var t=[],o=0;e>o;o++)t.push(s.createFlockEntity(s.preyStats,{position:new r({x:i.getRandomNumber(0,s.box.width),y:i.getRandomNumber(0,s.box.height)}),velocity:new r({x:i.getRandomNumber(-1,1),y:i.getRandomNumber(-1,1)})},n.PREY));return t},s.createPredatorsArray=function(e){for(var t=[],o=0;e>o;o++)t.push(s.createFlockEntity(s.predatorStats,{position:new r({x:i.getRandomNumber(0,s.box.width),y:i.getRandomNumber(0,s.box.height)}),velocity:new r({x:i.getRandomNumber(-1,1),y:i.getRandomNumber(-1,1)})},n.PREDATOR));return t},s.updateEntity=function(e){e.update({box:s.box,prey:s.entities.prey,predators:s.entities.predators})},s.update=function(){s.entities.predators.forEach(function(e){s.updateEntity(e)}),s.entities.prey.forEach(function(e){s.updateEntity(e)}),s.predatorsKillPrey(),e.$apply()},s.killPreyZombies=function(e){s.entities.predators.push(s.createFlockEntity(s.predatorStats,e,n.PREDATOR)),s.entities.prey.splice(s.entities.prey.indexOf(e),1)},s.killPreyWolves=function(e){s.entities.prey.splice(s.entities.prey.indexOf(e),1)},s.predatorsKillPrey=function(){s.entities.predators.forEach(function(e){var t=i.getNearestObjects(s.entities.prey,e,7);t.forEach(function(e){s["killPrey"+s.gameType](e)})})},s.clear=function(){s.entities.prey=[],s.entities.predators=[]}}]).config(["$stateProvider",function(e){e.state("app.flock",{url:"flock",resolve:{},views:{"main@":{templateUrl:"flockDemo.html",controller:"FlockController",controllerAs:"flockCtrl"}}})}])}(angular),function(e){"use strict";e.module("aidemo.life",["ui.router","aidemo.service.utils","aidemo.service.mathUtils","aidemo.service.drawUtils","aidemo.service.gridService","aidemo.service.screenSize","aidemo.models.lifeCell"]).controller("LifeController",["$scope","Utils","MathUtils","DrawUtils","GridService","ScreenSize","LifeCell",function(e,t,i,o,r,n,s){var a=this;a.BACK_COLOR="#555555",a.GRID_COLOR="#8EAEC9",a.generation=0,a.step=1,a.pause=!0,a.gridObj={grid:[],tileSize:10},a.lastTime=0,a.cumulativeTime=0;var c=n.getViewPort();a.viewport={height:c.height/2-c.height%a.gridObj.tileSize,width:c.width/2-c.width%a.gridObj.tileSize},a.generateGridColumns=function(e,t){for(var o=[],r=0;e>r;r++){var n=i.getRandomNumber(0,1)<=.1;o.push(new s({box:{x:r*a.gridObj.tileSize,y:t*a.gridObj.tileSize,width:a.gridObj.tileSize,height:a.gridObj.tileSize},status:n?s.ALIVE:s.DEAD,DEAD_COLOR:a.BACK_COLOR}))}return o},a.generateGrid=function(){var e=a.box.height/a.gridObj.tileSize,t=a.box.width/a.gridObj.tileSize;a.gridObj.grid=[];for(var i=0;e>i;i++){var o=a.generateGridColumns(t,i);a.gridObj.grid.push(o)}r.fillGridNeighbors(a.gridObj.grid,!1)},a.nextGeneration=function(){a.generation++;for(var t=r.deepCopyGrid(a.gridObj.grid,s,!1),i=0;i<a.gridObj.grid.length;i++)for(var o=0;o<a.gridObj.grid[i].length;o++)a.gridObj.grid[i][o].setStatus(t[i][o].update());e.$apply()},a.update=function(){if(!a.pause){var e=(new Date).getTime();a.cumulativeTime+=(e-a.lastTime)/1e3,a.lastTime=e,a.cumulativeTime>a.step&&(a.nextGeneration(),a.cumulativeTime=0)}},a.reset=function(){a.generateGrid(),a.generation=0},a.pauseToggle=function(){a.pause=!a.pause,0===a.gridObj.grid.length&&a.generateGrid()},a.spawnCell=function(e,t){var i=Math.max(Math.round(e/a.gridObj.tileSize)-1,0),o=Math.max(Math.round(t/a.gridObj.tileSize)-1,0);a.gridObj.grid[o][i].setStatus(s.ALIVE)},a.touch=function(e){if(0!==a.gridObj.grid.length){var t=e.offsetX-1,i=e.offsetY-1;a.spawnCell(t,i)}}}]).config(["$stateProvider",function(e){e.state("app.life",{url:"life",resolve:{},views:{"main@":{templateUrl:"lifeDemo.html",controller:"LifeController",controllerAs:"lifeCtrl"}}})}])}(angular),function(e){"use strict";e.module("aidemo.astar",["ui.router","aidemo.service.screenSize","aidemo.service.utils","aidemo.service.mathUtils","aidemo.service.aStar","aidemo.service.gridService","aidemo.models.vector","aidemo.models.node"]).controller("AStarController",["$timeout","ScreenSize","AStar","GridService","MathUtils","Vector","Node",function(e,t,i,o,r,n,s){var a=this;a.BACK_COLOR="#555555",a.GRID_COLOR="#8EAEC9",a.gridObj={grid:[],tileSize:20},a.start=null,a.end=null;var c=t.getViewPort();a.viewport={height:c.height/1.5+c.height%a.gridObj.tileSize+a.gridObj.tileSize/2,width:c.width/1.5+c.width%a.gridObj.tileSize+a.gridObj.tileSize/2},a.findNodeInGridAndPathSelect=function(e){if(a.gridObj.grid){var t=parseInt(e.id/a.gridObj.grid[0].length,10),i=parseInt(e.id-t*a.gridObj.grid[0].length,10);a.gridObj.grid[t][i]=e,a.gridObj.grid[t][i].pathSelect()}},a.markPath=function(e){if(e){for(;!e.isEmpty();){var t=e.dequeue();a.findNodeInGridAndPathSelect(t)}o.fillGridNeighbors(a.gridObj.grid,!0)}},a.createPath=function(){a.start&&a.end&&a.markPath(i.aStarAlgorithm(a.start,a.end,a.gridObj.grid,a.gridObj.tileSize))},a.selectStartNode=function(e){for(var t=0;t<a.gridObj.grid.length;t++)for(var i=0;i<a.gridObj.grid[t].length;i++)a.gridObj.grid[t][i]&&(a.gridObj.grid[t][i].reset(),a.gridObj.grid[t][i].specialSelect(e)&&(a.start=a.gridObj.grid[t][i]))},a.selectEndNode=function(e){for(var t=0;t<a.gridObj.grid.length;t++)for(var i=0;i<a.gridObj.grid[t].length;i++)a.gridObj.grid[t][i]&&a.gridObj.grid[t][i].eligibleForSelect(e)&&(a.end=a.gridObj.grid[t][i]);a.createPath()},a.reset=function(){a.start=null,a.end=null;for(var e=0;e<a.gridObj.grid.length;e++)for(var t=0;t<a.gridObj.grid[e].length;t++)a.gridObj.grid[e][t]&&a.gridObj.grid[e][t].reset()},a.handleTouchPosition=function(e){a.start?a.end?a.reset():a.selectEndNode(e):a.selectStartNode(e)},a.generateNode=function(e,t,i,o,c,h){var l=r.getRandomNumber(0,1)<=.7;return l?new s({box:{x:i*a.gridObj.tileSize,y:o*a.gridObj.tileSize,width:a.gridObj.tileSize,height:a.gridObj.tileSize},id:h.toString(),position:new n({x:i*a.gridObj.tileSize+c,y:o*a.gridObj.tileSize+c})}):null},a.generateGridRow=function(e,t,i,o,r){for(var n=[],s=0;e>s;s++)n.push(a.generateNode(e,t,s,i,o,r)),r++;return n},a.generateGrid=function(){var e=0,t=a.gridObj.tileSize,i=a.box.width-a.gridObj.tileSize,r=a.box.height-a.gridObj.tileSize,n=Math.floor(i/a.gridObj.tileSize),s=Math.floor(r/a.gridObj.tileSize);a.gridObj.grid=[];for(var c=0;s>c;c++)a.gridObj.grid.push(a.generateGridRow(n,s,c,t,e)),e+=n;o.fillGridNeighbors(a.gridObj.grid,!0)},a.touch=function(e){if(0!==a.gridObj.grid.length&&("mouseup"===e.type||"touchend"===e.type)){var t=new n({x:e.offsetX-1,y:e.offsetY-1});a.handleTouchPosition(t)}},a.render=function(e){a.gridObj.grid.forEach(function(t){t.forEach(function(t){t&&!(t.selected||t.special||t.path)&&t.render(e)})}),a.gridObj.grid.forEach(function(t){t.forEach(function(t){t&&(t.selected||t.special||t.path)&&t.render(e)})})},e(a.generateGrid,100)}]).config(["$stateProvider",function(e){e.state("app.astar",{url:"astar",resolve:{},views:{"main@":{templateUrl:"astarDemo.html",controller:"AStarController",controllerAs:"AStarCtrl"}}})}])}(angular),function(e){"use strict";e.module("aidemo.ant",["ui.router","aidemo.service.screenSize","aidemo.service.mathUtils","aidemo.service.drawUtils","aidemo.models.vector","aidemo.models.ants.ant","aidemo.models.ants.food","aidemo.models.ants.nest"]).controller("AntController",["$scope","MathUtils","DrawUtils","ScreenSize","Vector","Nest","Ant","Food",function(e,t,i,o,r,n,s,a){var c=this;c.box={},c.BACK_COLOR="#555555",c.GRID_COLOR="#8EAEC9",c.environment={food:[],pheromones:[],nest:null,ants:[]},c.active=!1,c.lastTime=0,c.antStats={cohesionWeight:.25,separateWeight:.25,alignWeight:.01,avoidWeight:.1,pheromoneWeight:.25};var h=o.getViewPort();c.viewport={height:h.height/2.2,width:h.width/2},c.spawnFood=function(){return new a({position:new r({x:t.getRandomNumber(10,c.box.width-10),y:t.getRandomNumber(10,c.box.height-10)})})},c.spawnNest=function(){return new n({position:new r({x:t.getRandomNumber(10,c.box.width-10),y:t.getRandomNumber(10,c.box.height-10)}),weights:c.antStats,foodStore:30})},c.createEnvironment=function(){for(var e=Math.round(t.getRandomNumber(5,10)),i=0;e>i;i++)c.environment.food.push(c.spawnFood());c.environment.nest=c.spawnNest(),c.active=!0},c.clear=function(){c.environment={food:[],pheromones:[],nest:null,ants:[]},c.active=!1},c.reset=function(){c.clear(),c.createEnvironment()},c.spawnAnt=function(e){var t=c.environment.nest.updateTimeAndAttemptToSpawnAnt(e);t&&c.environment.ants.push(t)},c.addPheromoneToEnvironment=function(e){e&&c.environment.pheromones.push(e)},c.getTouchedFood=function(e){var i=t.getNearestObjects(c.environment.food,e,10);return i.length>0?c.environment.food.indexOf(i[0]):null},c.antTouchedFood=function(e){return _.isNumber(e)?(c.environment.food[e].takeBite()&&c.environment.food.splice(e,1),!0):!1},c.getTouchedNest=function(e){var i=t.getNearestObjects([c.environment.nest],e,10);return i.length>0?i[0]:null},c.antTouchedNest=function(e,t){return e&&t.hasFood?(c.environment.nest.addFood(),!1):!0},c.antTouchedEnvironment=function(e){if(e.hasFood){var t=c.getTouchedNest(e);return c.antTouchedNest(t,e)}var i=c.getTouchedFood(e);return c.antTouchedFood(i)},c.updateAnts=function(e){var t=[];for(var i in c.environment.ants)if(c.environment.ants[i]){c.environment.ants[i].update({box:c.box,ants:c.environment.ants,food:c.environment.food,pheromones:c.environment.pheromones,nest:c.environment.nest});var o=c.environment.ants[i].attemptToSpawnPheromone(e);c.addPheromoneToEnvironment(o),c.environment.ants[i].hasFood=c.antTouchedEnvironment(c.environment.ants[i])}t.forEach(function(){})},c.updatePheromones=function(e){var t=[];c.environment.pheromones.forEach(function(i){i.update(e)&&t.push(i)}),t.forEach(function(e){c.environment.pheromones.splice(c.environment.pheromones.indexOf(e),1)})},c.update=function(){if(c.active){var t=(new Date).getTime(),i=Math.min((t-c.lastTime)/1e3,1);c.lastTime=t,c.spawnAnt(i),c.updateAnts(i),c.updatePheromones(i),e.$apply()}}}]).config(["$stateProvider",function(e){e.state("app.ant",{url:"ant",resolve:{},views:{"main@":{templateUrl:"antDemo.html",controller:"AntController",controllerAs:"antCtrl"}}})}])}(angular),function(e){"use strict";e.module("aidemo.chip",["ui.router","aidemo.service.mathUtils","aidemo.service.drawUtils","aidemo.models.vector","aidemo.models.chip.globals","aidemo.models.chip.player","aidemo.models.chip.item","aidemo.models.chip.tile"]).controller("ChipController",["MathUtils","DrawUtils","Vector","Globals","Player","Item","Tile",function(e,t,i,o,r,n,s){var a=this;a.BACK_COLOR="#555555",a.GRID_COLOR="#8EAEC9";var c=[n.FLIPPERS,n.FIRE_BOOTS,n.ROLLER_SKATES,n.ICE_SKATES,n.BLUE_KEY,n.RED_KEY,n.YELLOW_KEY,n.GREEN_KEY],h=function(e){return 0!==a.gameStats.chipsRemaining?!1:(e.removeObstacle(),!0)},l=function(e){var t=e.getObstacle().doorToKey();return null===a.player.specialSlots[t]?!1:(e.removeObstacle(),a.player.removeItem(t),!0)},u=function(e,t){return t.getType()===s.WATER?(e.removeObstacle(),t.setType(s.WATER_BLOCK),!0):t.getType()===EMPTY&&null===t.getItem()&&null===t.getObstacle()?(t.setObstacle(e.getObstacle()),e.removeObstacle(),!0):!1},d=function(e,t){var i=e.getNeighborTileInDirection(t);if(e.getType()===BLOCK)return!1;if(null!==e.getObstacle()){var o=e.getObstacle();if(o.getType()===CHIPDOOR)return h(e);if(o.isDoor())return l(e);if(o.getType()===PUSHBLOCK)return u(e,i)}return!0},p=function(e,t,i,o){return e===i&&t>=i&&o>=t||e===o&&t>=i&&o>=t||t===i&&e>=i&&o>=e||t===o&&e>=i&&o>=e},g=function(e,t,i,o){return e>i&&o>e&&t>i&&o>t},m=function(t){return t?e.getRandomNumber(0,1)<.075?e.getRandomNumber(0,1)<.5?s.WATER:s.FIRE:e.getRandomNumber(0,1)<.1?s.WATER_BLOCK:s.EMPTY:s.EMPTY},f=function(t,r){var h,l=null;if(p(t,r,a.world.lower,a.world.upper))h=s.BLOCK;else if(t===a.world.upper-1&&r===a.world.upper-1)h=s.EXIT;else{var u=g(t,r,a.world.lower,a.world.upper);h=m(u),h===s.EMPTY&&u&&(0!==c.length&&e.getRandomNumber(0,1)<.1?l=new n({type:c.pop()}):e.getRandomNumber(0,1)<.05&&(a.gameStats.chipsRemaining++,l=new n({type:n.MICRO_CHIP})))}return new s({screenPos:new i({x:t*o.TILE_SIZE,y:r*o.TILE_SIZE}),worldPos:new i({x:t*o.TILE_SIZE,y:r*o.TILE_SIZE}),type:h,item:l})};a.canvas=$("#gameCanvas")[0],a.box={width:a.canvas.width,height:a.canvas.height,center:new i({x:a.canvas.width/2,y:a.canvas.height/2})},a.ctx=a.canvas.getContext("2d"),a.itemCtx=$("#itemCanvas")[0].getContext("2d"),a.gameStats={level:1,timeRemaining:0,chipsRemaining:0},a.presetWorld={grid:[],x:20,y:20,tileSize:o.TILE_SIZE,lower:3,upper:16};var y=4*a.presetWorld.tileSize,v=4*a.presetWorld.tileSize;a.player=new Chip({screenPos:new i({x:y,y:y}),worldPos:new i({x:v,y:v})}),a.toHome=function(){NavService.NavToHome()},$rootScope.$on("keypress",function(e,t,i){$scope.$apply(function(){a.handleKeyPress(i)})}),a.handleKeyPress=function(e){a.player.getStatus()===o.ALIVE&&("s"===e?a.moveAll(o.DOWN):"a"===e?a.moveAll(o.LEFT):"w"===e?a.moveAll(o.UP):"d"===e&&a.moveAll(o.RIGHT),"p"===e&&a.world.grid[8][8].setObstacle(new Obstacle({type:PUSHBLOCK})))},a.moveAll=function(e){var t=e.divNew(o.TILE_SIZE).addNew(a.player.getTileIndex()),i=a.world.grid[t.y][t.x];d(i,e)&&(a.player.move(e),a.moveWorld(e.mulNew(-1)),a.grabMicrochip(i),a.player.handleTile(i))},a.moveWorld=function(e){for(var t=0;t<a.world.grid.length;t++)for(var i=0;i<a.world.grid[t].length;i++)a.world.grid[t][i].move(e)},a.grabMicrochip=function(e){var t=e.getItem();null!==t&&t.getType()===n.MICRO_CHIP&&a.gameStats.chipsRemaining--},a.generateWorld=function(){a.world=a.presetWorld;for(var e=0;e<a.world.x;e++){for(var t=[],i=0;i<a.world.y;i++)t.push(f(i,e));a.world.grid.push(t)}var o=a.world.upper;a.world.grid[o-1][o-3].setObstacle(new Obstacle({type:REDDOOR})),a.world.grid[o-1][o-4].setObstacle(new Obstacle({type:BLUEDOOR})),a.world.grid[o-1][o-5].setObstacle(new Obstacle({type:GREENDOOR})),a.world.grid[o-1][o-6].setObstacle(new Obstacle({type:YELLOWDOOR})),a.world.grid[o-1][o-2].setObstacle(new Obstacle({type:CHIPDOOR})),a.world.grid[o-2][o-2].setObstacle(new Obstacle({type:CHIPDOOR})),a.world.grid[o-2][o-1].setObstacle(new Obstacle({type:CHIPDOOR})),fillNeighbors(a.world.grid,!0)}()}]).config(["$stateProvider",function(e){e.state("app.chip",{url:"chip",resolve:{},views:{"main@":{templateUrl:"chipsChallenge.html",controller:"ChipController",controllerAs:"chipCtrl"}}})}])}(angular),function(e){"use strict";var t=e.module("aidemo.app",["ui.router","aidemo.templates","aidemo.ui.canvas","aidemo.flock","aidemo.ant","aidemo.life","aidemo.astar","aidemo.chip"]);t.controller("HeaderController",["$rootScope","$state","$window",function(e,t,i){var o=this;o.currentState=t.current.name,o.homeLink={state:"app",name:"Home",inactive:!1},o.links=[{state:"app.life",name:"Life",inactive:!1},{state:"app.flock",name:"Swarming",inactive:!1},{state:"app.ant",name:"Ants",inactive:!1},{state:"app.astar",name:"A Star",inactive:!1},{state:"app.chip",name:"Chip's Challenge",inactive:!0}],e.$on("$stateChangeStart",function(e,t){o.currentState=t.name}),o.goToBlog=function(){i.location.href="http://holdenprofit.com/"}}]),t.controller("DashboardController",["$scope","$state",function(){}]),t.config(["$stateProvider","$urlRouterProvider",function(e,t){t.when("","/"),e.state("app",{url:"/",views:{"header@":{templateUrl:"header.html",controller:"HeaderController",controllerAs:"headCtrl"},"main@":{templateUrl:"dashboard.html",controller:"DashboardController"}}})}])}(angular);